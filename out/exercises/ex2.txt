1:"$Sreact.fragment"
2:I[2034,["173","static/chunks/173-7be02dd55462ff0c.js","678","static/chunks/678-9555f6ed956a8d40.js","177","static/chunks/app/layout-da0fd956609a208e.js"],"SidebarProvider"]
3:I[1543,["173","static/chunks/173-7be02dd55462ff0c.js","678","static/chunks/678-9555f6ed956a8d40.js","177","static/chunks/app/layout-da0fd956609a208e.js"],"AppSidebar"]
4:I[2034,["173","static/chunks/173-7be02dd55462ff0c.js","678","static/chunks/678-9555f6ed956a8d40.js","177","static/chunks/app/layout-da0fd956609a208e.js"],"SidebarTrigger"]
5:I[5244,[],""]
6:I[3866,[],""]
8:I[6213,[],"OutletBoundary"]
a:I[6213,[],"MetadataBoundary"]
c:I[6213,[],"ViewportBoundary"]
e:I[4835,[],""]
:HL["/cmput412-akhadeli/_next/static/media/a34f9d1faa5f3315-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/cmput412-akhadeli/_next/static/css/f8c155f11af27ff1.css","style"]
:HL["/cmput412-akhadeli/_next/static/css/e23141aac3fba32d.css","style"]
7:T456,prose prose-headings:mt-8 prose-headings:font-semibold prose-headings:text-black prose-h1:text-5xl prose-h2:text-4xl prose-h3:text-3xl prose-h4:text-2xl prose-h5:text-xl prose-h6:text-lg dark:prose-headings:text-white prose-md prose-p:text-lg prose-p:leading-relaxed prose-p:text-gray-800 dark:prose-p:text-gray-100 prose-table:w-full prose-table:border-collapse prose-table:border-gray-300 prose-table:dark:border-gray-600 prose-table:text-left prose-table:text-sm prose-table:text-gray-800 dark:prose-table:text-gray-100 prose-ul:text-gray-800 dark:prose-ul:text-gray-100 prose-li:text-gray-800 dark:prose-li:text-gray-100 prose-strong:text-gray-800 prose-strong:font-bold dark:prose-strong:text-gray-100 prose-img:w-full prose-img:rounded-lg prose-img:border prose-img:border-border prose-img:dark:border-border prose-video:w-full prose-video:rounded-lg prose-video:border prose-video:border-border prose-video:dark:border-border prose-iframe:w-full prose-iframe:rounded-lg prose-iframe:border prose-iframe:border-border prose-iframe:dark:border-border prose-span:text-gray-800 prose-span:dark:text-gray-1000:{"P":null,"b":"-3JL66e0Tt11N3vuv3w79","p":"/cmput412-akhadeli","c":["","exercises","ex2"],"i":false,"f":[[["",{"children":["exercises",{"children":["ex2",{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/cmput412-akhadeli/_next/static/css/f8c155f11af27ff1.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__className_23f766 antialiased","children":["$","$L2",null,{"children":[["$","$L3",null,{}],["$","$L4",null,{"className":"ml-3 mt-3"}],["$","main",null,{"className":"flex-1 overflow-auto p-8 pt-16","children":["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[],[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]]}]}]}]]}],{"children":["exercises",["$","$1","c",{"children":[null,["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","exercises","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["ex2",["$","$1","c",{"children":[null,["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","exercises","children","ex2","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":[["$","main",null,{"className":"mx-auto max-w-3xl","children":["$","div",null,{"className":"$7","children":[["$","h1",null,{"children":"CMPUT 412/503 - Exercise 2 Report"}],"\n",["$","h2",null,{"children":"Abdullah Khadeli and Ryan Rom"}],"\n",["$","h3",null,{"children":"Part I: Getting comfortable with ROS"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["\n",["$","p",null,{"children":[["$","strong",null,{"children":"Node"}],": An executable file within a ROS package. Each node should be built to perform specific tasks like controlling sensors or motors, and communicating with other nodes by publishing and subscribing to topics."]}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":[["$","strong",null,{"children":"Topic"}],": Topics are a way to exchange mnessages betwee nodes by using a pubsub model. Publishers send messages to topics, while subscribers receive them, allowing for decoupled communication."]}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":[["$","strong",null,{"children":"Service"}],": Services provide an alternative communication mechanism between nodes. Unlike the asynchronous nature of topics, services are for operations requiring a request-response interaction, like querying sensor states."]}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":[["$","strong",null,{"children":"Message"}],": Messages provide typed data schemas for node communication. They provide support for different types of data exchanged between nodes."]}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":[["$","strong",null,{"children":"Bag"}],": A method to record messages sent through a topic. Since timestamps are attached to each message, it allows for the playback of the messages in the order they were sent, and thus analysis of the time-series data."]}],"\n"]}],"\n"]}],"\n",["$","h4",null,{"children":"Typical workflow for communication"}],"\n",["$","p",null,{"children":"The typical workflow for setting up node communication involves:"}],"\n",["$","ol",null,{"children":["\n",["$","li",null,{"children":"Creating your nodes"}],"\n",["$","li",null,{"children":"Defining message schemas using the built-in message types"}],"\n",["$","li",null,{"children":"Attaching publishers and subscribers to the appropriate topics"}],"\n",["$","li",null,{"children":"Launching the respective nodes"}],"\n",["$","li",null,{"children":"Additionally collect data using rosbag for playback and analysis"}],"\n"]}],"\n",["$","p",null,{"children":"The following images show my-publisher.py publishing messages and my-subscriber.py reading the published messages running from the duckiebot."}],"\n",["$","p",null,{"children":["$","img",null,{"src":"/cmput412-akhadeli/images/ex2/pub-sub-simple.png","alt":"Publisher and Subscriber"}]}],"\n",["$","p",null,{"children":"Afterwards, we subscribed to the topic containing the output of the camera.\nWe then transformed the read image into grayscale and annotated it using OpenCV and published the compressed output on a custom topic.\nWe opened rqt_image_view and used the outputs from the custom topic showing this screenshot."}],"\n",["$","p",null,{"children":["$","img",null,{"src":"/cmput412-akhadeli/images/ex2/annotated-image.png","alt":"Annotated Image"}]}],"\n",["$","h3",null,{"children":"Part II: Odometry using wheel encoders"}],"\n",["$","h4",null,{"children":"Straight line task"}],"\n",["$","p",null,{"children":"To achieve the straight line task, we set a target distance to travel, and using the tick and resolution\ninformation provided by the motor encoders, and the wheel radius, we can calculate the current distance travelled,\nand therefore terminate the event loop when the current distance travelled is within a tolerance threshold of the target distance."}],"\n",["$","video",null,{"src":"/cmput412-akhadeli/images/ex2/straight.mp4","controls":true}],"\n",["$","p",null,{"children":"Here is a video of the robot driving in a straight line forwards and backwards."}],"\n",["$","p",null,{"children":"Most of the time the bot stops near exact distance (1.25m) but sometimes it goes way over it.\nWe believe that there are a few reasons for this:"}],"\n",["$","ol",null,{"children":["\n",["$","li",null,{"children":"Lag in the connection between the messages that the publisher and subscriber communicate with, imparted due to the high refresh rate we forced the robot to run at."}],"\n",["$","li",null,{"children":"The uneven surface of the mat leads to drifting away from the desired path."}],"\n",["$","li",null,{"children":"Observer encoder inaccuracies when the robot is driving on the surface, likely due to the weight of the robot."}],"\n"]}],"\n",["$","pre",null,{"children":["$","code",null,{"children":"WheelsCMDStamped(vel_left=0, vel_right=0)\n"}]}],"\n",["$","p",null,{"children":"Furthermore, the uneven surface of the mat leads to drift into one direction."}],"\n",["$","p",null,{"children":"We found that setting the speed to full throttle is the best option to compensate for the unevenness of the surface, therefore we applied full throttle to the robot."}],"\n",["$","p",null,{"children":"Increasing the speed leads to more accurate results in our case.\nThis is likely because the mat used for the robot has been tampered a lot over 2 weeks as other students use it for their testing and a lot of accidental stepping on mat has happened, creating unevenness.\nDecreasing the speed leads to less accurate results like for the same reason expressed previously."}],"\n",["$","p",null,{"children":["$","img",null,{"src":"/cmput412-akhadeli/images/ex2/straight_plot.png","alt":"Straight Plot"}]}],"\n",["$","h4",null,{"children":"Rotation task"}],"\n",["$","p",null,{"children":"To achieve the rotation task, we set a target angle to rotate to, and using the tick and resolution\ninformation provided by the motor encoders, and the wheel radius, we can calculate the current angle of rotation,"}],"\n",["$","span",null,{"className":"katex-display","children":["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","display":"block","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"mathvariant":"normal","children":"Δ"}],["$","mi",null,{"children":"θ"}],["$","mo",null,{"children":"="}],["$","mfrac",null,{"children":[["$","mrow",null,{"children":[["$","msub",null,{"children":[["$","mi",null,{"children":"d"}],["$","mi",null,{"children":"R"}]]}],["$","mo",null,{"children":"−"}],["$","msub",null,{"children":[["$","mi",null,{"children":"d"}],["$","mi",null,{"children":"L"}]]}]]}],["$","mrow",null,{"children":[["$","mn",null,{"children":"2"}],["$","msub",null,{"children":[["$","mi",null,{"children":"d"}],["$","mi",null,{"children":"w"}]]}]]}]]}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"\\Delta \\theta = \\frac{d_R - d_L}{2d_w}\n"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6944em"}}],["$","span",null,{"className":"mord","children":"Δ"}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.02778em"},"children":"θ"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"2.2074em","verticalAlign":"-0.836em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mopen nulldelimiter"}],["$","span",null,{"className":"mfrac","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"1.3714em"},"children":[["$","span",null,{"style":{"top":"-2.314em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord","children":"2"}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"d"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.1514em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.02691em"},"children":"w"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}]]}]]}],["$","span",null,{"style":{"top":"-3.23em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"frac-line","style":{"borderBottomWidth":"0.04em"}}]]}],["$","span",null,{"style":{"top":"-3.677em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"d"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3283em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.00773em"},"children":"R"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}],["$","span",null,{"className":"mbin","children":"−"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"d"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3283em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"L"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}]]}]]}]]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.836em"},"children":["$","span",null,{}]}]}]]}]}],["$","span",null,{"className":"mclose nulldelimiter"}]]}]]}]]}]]}]}],"\n",["$","p",null,{"children":"and therefore terminate the event loop when the current angle of rotation is within a tolerance threshold of the target angle."}],"\n",["$","video",null,{"src":"/cmput412-akhadeli/images/ex2/rotation.mp4","controls":true}],"\n",["$","p",null,{"children":"One of the most pressing problems we faced in the rotation task is overshooting.\nAfter spending a long time tweaking our implementation, we achieved near exact 90 degree rotation in most of our runs.\nHowever, sometimes it overshoots and, rarely, its spins around more than 360 degrees.\nIt mainly came from the lag and number of published messages per second.\nThere was nothing we can do about the former. For the latter, we set a tolerance threshold such that when the read that total change in angle of the robot frame is within that lower threshold we stop the robot.\nAs well, we increased the number of published messages per second. This makes the interval of error really small so it only overshoots a little if we ever do and there is no lag."}],"\n",["$","p",null,{"children":"Our programs did not finish properly in the beginning.\nWhen we shutdown our program for the first time, the robot's wheels kept spinning even though the run function already finished.\nWe, however, quickly realized this after looking at the sample exercises (E.g. camera reader).\nWe defined an on_shutdown() callback to our node that publishes a command to the wheels of the robot that set the velocity of each wheel to 0.\nAfter we defined this in our DTROS subclasses, our nodes shutdown properly."}],"\n",["$","p",null,{"children":["$","img",null,{"src":"/cmput412-akhadeli/images/ex2/rotation_plot.png","alt":"Rotation Plot"}]}],"\n",["$","h3",null,{"children":"Part III: Playing with Duckiebots"}],"\n",["$","p",null,{"children":"After building our main node and service nodes and hours of testing and tweaking their parameters, we achieved our best run on running the Duckiebot to traced a D path."}],"\n",["$","video",null,{"src":"/cmput412-akhadeli/images/ex2/d-path-2.mp4","controls":true}],"\n",["$","p",null,{"children":["The main node is responsible for the logic of controlling the wheels of the duckiebot.\nIt also publishes a msg to /csc22909/state. The service node subscribes to this topic.\nThere are three states Stopping, Moving, and Exiting. The service node handles the lights to output ",["$","strong",null,{"children":"Red"}]," meaning the duckiebot is in a ",["$","strong",null,{"children":"stopped state"}]," and ",["$","strong",null,{"children":"Green"}]," means that the duckiebot is ",["$","strong",null,{"children":"moving"}],".\nWhen the node shuts down, we turn the lights off."]}],"\n",["$","p",null,{"children":["$","img",null,{"src":"/cmput412-akhadeli/images/ex2/D_plot.png","alt":"D Path Plot"}]}],"\n",["$","p",null,{"children":["$","img",null,{"src":"/cmput412-akhadeli/images/ex2/exec-time.png","alt":"Total Execution Time"}]}],"\n",["$","p",null,{"children":"Accumulation of small errors leading to big errors in the long run (E.g. minor deviation from the first straight line task in the D path tracing leads to the robot not reaching the end position)\nIt is also very hard to get accurate movement from the robot because of the reasons stated in the previous parts."}],"\n",["$","h3",null,{"children":"Reflection"}],"\n",["$","p",null,{"children":"Overall, we learned a lot about ROS and Duckiebots, and especially about tweaking the parameters of the robot to get the best performance."}],"\n",["$","h3",null,{"children":"Code"}],"\n",["$","p",null,{"children":["Find the code using the link\n",["$","a",null,{"href":"https://github.com/akhadeli/cmput412-akhadeli-code","children":"Code"}]]}],"\n",["$","h3",null,{"children":"References"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["$","a",null,{"href":"https://wiki.ros.org/ROS/Tutorials","children":"ROS Documentation"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"https://docs.duckietown.com/daffy/devmanual-software/beginner","children":"Duckiebot Documentation"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"https://medium.com/@nahmed3536/wheel-odometry-model-for-differential-drive-robotics-91b85a012299","children":"Medium Article"}]}],"\n"]}]]}]}],[["$","link","0",{"rel":"stylesheet","href":"/cmput412-akhadeli/_next/static/css/e23141aac3fba32d.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","$L8",null,{"children":"$L9"}]]}],{},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,["$","$1","aXOk1xZKwX2TLfz73bRfY",{"children":[["$","$La",null,{"children":"$Lb"}],["$","$Lc",null,{"children":"$Ld"}],["$","meta",null,{"name":"next-size-adjust","content":""}]]}]]}],false]],"m":"$undefined","G":["$e","$undefined"],"s":false,"S":true}
d:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
b:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"CMPUT 412/503 - Abdullah Khadeli"}],["$","meta","2",{"name":"description","content":"A documentation site for CMPUT 412/503 - Abdullah Khadeli"}],["$","link","3",{"rel":"icon","href":"/cmput412-akhadeli/favicon.ico","type":"image/x-icon","sizes":"16x16"}]]
9:null
